---
title: ìŠ¤í…Œì´ì§• ë‹¨ê³„ ì¶”ê°€
created: 2024-03-16 17:46
last-updated: 2024-03-16 19:15
tags:
  - ci/cd
  - github
---

## ğŸ‘¯â€â™‚ï¸ Intro & tl;dr


branch ë³„ë¡œ
- main -> prod
	- prod í™˜ê²½ë³€ìˆ˜
- develop -> dev
	- dev í™˜ê²½ë³€ìˆ˜ 
	- dev.icehongssii.xyz 
	- ê·¸ë ‡ë‹¤ë©´ dev í™˜ê²½ì¼ ë•Œì—ë„ ë ˆë””ìŠ¤ ë³´ì•ˆê·¸ë£¹ ì¶”ê°€

ê·¸ë ‡ë‹¤ë©´ ë¡œì»¬ì¼ ë•ŒëŠ” ì–´ë–»ê²Œ í…ŒìŠ¤íŠ¸í•˜ì§€?

í™˜ê²½ë³€ìˆ˜ ì£¼ì…ê³¼ì •,,

- github env -> workflow -> dockerfileì—   ARG && ENV ì •ì˜ -> app.pyì—ì„œ os.envë¡œ ê°€ì ¸ì˜¤ê¸° -> dockerbuildë‹¨ì—ì„œë„ ì„¤ì • í•„ìš”í•¨ 




ë¡œì»¬í™˜ê²½ì—ì„œ .envì €ì¥í•œë‚´ìš© ê± í•˜ê³  ì‹¶ìœ¼ë©´ ì´ë ‡ê²Œí•˜ë©´ ì¡°ì„ë“¯??

```sh
export $(cat .env | xargs)

docker build --build-arg REDIS_HOST=${REDIS_HOST} --build-arg REDIS_PWD=${REDIS_PWD} -t your-image-name .
```



```yaml
jobs:
  build-and-push:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Login to Amazon ECR
        uses: aws-actions/amazon-ecr-login@v1

      - name: Build, tag, and push image to Amazon ECR
        run: |
          docker build -t ${{ secrets.ECR_REPOSITORY }}:latest \
            --build-arg REDIS_HOST=${{ secrets.DD_REDIS_HOST }} \
            --build-arg REDIS_PWD=${{ secrets.DD_REDIS_PWD }} \
            .
          docker push ${{ secrets.ECR_REPOSITORY }}:latest
```

- í™˜ê²½ë§ˆë‹¤ ë°”ë€ŒëŠ”ê²ƒ(prod, stage)ì˜ˆë¥¼ë“¤ë©´ ë ˆë””ìŠ¤ ì„œë²„
- ê·¼ë° ë¡œì»¬ì´ë©´ ì–´ì¼€ì“°ì§•..?





--- 

## ğŸ‘¯â€â™‚ï¸ Ref & LINKS TO THIS PAGE

-  [ì±…/ìœ íŠœë¸Œ ì¸ê°•-í˜¼ì ê³µë¶€í•˜ëŠ” ì»´í“¨í„°êµ¬ì¡°+ìš´ì˜ì²´ì œ, ê°•ë¯¼ì² , í•œë¹›ë¯¸ë””ì–´](https://www.youtube.com/watch?v=kFWP6sFKyp0&list=PLYH7OjNUOWLUz15j4Q9M6INxK5J3-59GC)


